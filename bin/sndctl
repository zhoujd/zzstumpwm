#!/bin/bash

usage() {
    app=$(basename $0)
echo "Usage:
$app vol up
$app vol down
$app vol toggle
$app vol status
$app mic toggle
$app mic status
$app info
$app status"
}

info() {
    pactl info
}

vol_status () {
    DEFAULT_SINK=$(pactl info | grep "Default Sink" | cut -d " " -f3)
    vol_mute=$(pactl list | grep -E "Name: $DEFAULT_SINK$|Mute" | grep "Name:" -A1 | tail -1 |cut -d: -f2| tr -d " ")
    echo "Vol Mute: $vol_mute"
}

mic_status () {
    DEFAULT_SOURCE=$(pactl info | grep "Default Source" | cut -d " " -f3)
    mic_mute=$(pactl list | grep -E "Name: $DEFAULT_SOURCE$|Mute" | grep "Name:" -A1 | tail -1 |cut -d: -f2| tr -d " ")
    echo "Mic Mute: $mic_mute"
}

status () {
    vol_status
    mic_status
}

vol_up() {
    pacmd list-sinks | \
        grep -oP 'index: \d+' | \
        awk '{ print $2 }' | \
        xargs -I{} pactl set-sink-volume {} +10%
}

vol_down() {
    pacmd list-sinks | \
        grep -oP 'index: \d+' | \
        awk '{ print $2 }' | \
        xargs -I{} pactl set-sink-volume {} -10%
}

vol_toggle() {
    pacmd list-sinks | \
        grep -oP 'index: \d+' | \
        awk '{ print $2 }' | \
        xargs -I{} pactl set-sink-mute {} toggle
}

mic_toggle() {
    pacmd list-sources | \
        grep -oP 'index: \d+' | \
        awk '{ print $2 }' | \
        xargs -I{} pactl set-source-mute {} toggle
}

case $1 in
    vol )
        case $2 in
            up )
                vol_up
                ;;
            down )
                vol_down
                ;;
            toggle )
                vol_toggle
                ;;
            status )
                vol_status
                ;;
            * )
                echo "$0 $1 {up|down|toggle|status}"
                exit 1
        esac
        ;;
    mic )
        case $2 in
            toggle )
                mic_toggle
                ;;
            status )
                mic_status
                ;;
            * )
                echo "$0 $1 {toggle|status}"
                exit 1
        esac
        ;;
    info )
        info
        ;;
    status )
        status
        ;;
    * )
        usage
        ;;
esac
