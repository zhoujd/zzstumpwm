#!/bin/bash
#set -x -v

# get script path
script_path() {
    SOURCE=${BASH_SOURCE[0]}
    DIR=$(dirname "$SOURCE")
    while [ -h "$SOURCE" ]
    do
        SOURCE=$(readlink "$SOURCE")
        [[ $SOURCE != /* ]] && SOURCE="$DIR/$SOURCE"
        DIR=$( cd -P "$(dirname "$SOURCE")" && pwd)
    done
    DIR=$(cd -P "$(dirname "$SOURCE")" && pwd)
    echo $DIR
}

SCRIPT_ROOT=$(script_path)
ZZSTUMPWM_ROOT=$(cd $SCRIPT_ROOT/.. && pwd)
ZZXMODMAP_ROOT=$ZZSTUMPWM_ROOT/misc/.xmodmap

switch_xmodmap() {
    echo "switch to $1"
    setcapslock off
    xmodmap $1
    setcapslock off
}

case "$1" in
    "on" )
        switch_xmodmap $ZZXMODMAP_ROOT/hyper.xmodmap
        ;;
    "off" )
        switch_xmodmap $ZZXMODMAP_ROOT/default.xmodmap
        ;;
    "laptop" )
        switch_xmodmap $ZZXMODMAP_ROOT/laptop.xmodmap
        ;;
    * )
        echo "Usage: $(basename $0) {on|off|laptop}"
        ;;
esac
